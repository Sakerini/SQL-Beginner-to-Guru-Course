use northwind;
-- Create Sales Report by year, month, by state 
-- Show total revenue - List Price * order quantity
-- Limit to order lines invoiced

SELECT 
    DATE_FORMAT(order_date, '%Y - %m') AS 'Sales Month', 
    ord.ship_state_province as 'State',
    CONCAT('$',
            FORMAT((odt.quantity * products.list_price),
                2)) AS 'Total Sales'
FROM
    orders AS ord
        JOIN
    order_details odt ON ord.id = odt.order_id
        JOIN
    products ON odt.product_id = products.id
WHERE
    odt.status_id = 2
GROUP BY DATE_FORMAT(order_date, '%Y - %m'), ord.ship_state_province
ORDER BY 'Sales Month' ASC;{"threads":[{"position":0,"start":0,"end":316,"connection":"open"},{"position":631,"start":317,"end":631,"connection":"closed"}],"url":"https://udemy-assets-on-demand2.udemy.com/2018-06-28_08-37-22-9cb796e2969a8f93ea10870daee9e5de/original.sql?nva=20190309164632&download=True&filename=examples.sql&token=093576e3c13fbb12c8cd7","method":"GET","port":443,"downloadSize":631,"headers":{"content-length":"631","content-type":"application/force-download","etag":"\"6aa8efb41006ae3007b2f253777ce5eb\"","last-modified":"Thu, 28 Jun 2018 08:37:23 GMT","accept-ranges":"bytes","server":"AmazonS3","access-control-allow-origin":"*","content-disposition":"attachment; filename=examples.sql","x-amz-id-2":"9PIUfTQAOJfiwUgw3UJwU0SfH84S+9t2M6DgP4zm2ubQQ8XkqjjCUPs+kNaEHNkID1si0M4rLW0=","x-amz-meta-qqfilename":"examples.sql","x-amz-replication-status":"COMPLETED","x-amz-request-id":"43DF6729BE1BC48B","x-amz-version-id":"7LqGnGHE34rfrE3_ij0HmfFgqGpl9NaG","date":"Sat, 09 Mar 2019 12:27:38 GMT","connection":"close"}}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    